# 用户与用户组
```bash
每个使用者：
	用户标识、密码：
		Authentication 认证
		Authorization  授权
		Auditon        审计
	组：用户组，用户容器
用户类别：
	管理员
	普通用户
		系统用户
		登录用户
	用户标识：UserID,UID
		16bits二进制数字：0-65535
			管理员:0
			普通用户
				系统用户：1-499(CentOS6),1-999(CentOS7)
				登录用户：500-60000(CentOS6),1000-60000(CentOS7)
组类别：
	组类别1
		管理员组
		普通用户组
			系统用户组
			登录用户组
		组标识
			管理员组：0
			普通用户组:1-65535
				系统用户组：1-499(CentOS6),1-999(CentOS7)
				登录用户组：500-60000(CentOS6),1000-60000(CentOS7)
	组类别2
		用户组基本组
		用户的附加组
	组类别3
		私有组：组名同用户名，且只包括一个用户
		公共组：组内包含多个用户
认证信息：
	通过比对事先存储的，与登录时提供的信息
		password
			/etc/shadow
			/etc/gshadow
		加密算法：
			对称加密：加密和解密使用同一个密码
			非对称加密：加密和解密使用一对秘钥
				秘钥对
					公钥：public key
					私钥：private key
		单向加密：只能加密，不能解密，提取数据特征码
			定长输出
			雪崩效应
			算法
				md5：message digest,128bits
				sha:secure hash algorithm，160bits
				sha22
				sha256
				sha384
				sha512	
				在计算之前加salt，添加随机数
各信息文件：
	/etc/passwd：用户的信息库
		name:password:UID:GID:GECOS:directory:shell
		name：用户名
		password：可以是加密的密码，也可以是占位符x
		GID：用户所属的主组的ID号
		GECOS：注释信息
		directory：用户的家目录
		shell：用户的默认shell，登录时默认shell程序
		
	/etc/shadow：用户密码
		用户名：加密的密码：最近一次修改密码的时间：最短使用期限：最长使用期限：警告期限：过期期限：保留字段
		
	/etc/group：组的信息库
		group_name:password:GID:user_list
			user_list：该组的用户成员，以此组为附加组的用户列表
		
```
# 用户和用户组管理
```bash
安装上下文
	进程以其发起者的身份运行
		进程对文件的访问权限，取决于发起此进程的用户的权限
系统用户
	为了能够让那些后台进程或服务类进程以非管理员的身份运行，通常需要为此创
	建多个普通用户，这类用户从不用登录系统

groupadd：添加组
	-g GID : 指定GID，默认是上一个组的GID
	-r : 创建系统组
groupmod: 修改组属性
	-g GID : 修改GID
	-n new_name : 修改组名
groupdel: 删除组

useradd: 创建用户
	-u, --uid UID: 指定UID
	-g, --gid GROUP: 指定基本组ID，此组得事先存在
	-G, --groups GROUP1[,GROUP2,...]: 指定用户所属的附加组，多个组用逗号
	-c, --comment COMMENT: 指定注释信息
	-d, --home_dir: 以指定路径为用户家目录，通过复制/etc/skel此目录并重命
		名实现；指定的家目录如事先存在，则不会为用户复制环境配置文件
	-s, --shell: 指定用户的默认shell
	-r, --system: 创建系统用户
	注意：创建系统用户时的诸多默认配置为/etc/login.defs
	-M,不创建家目录
useradd -D: 显示创建用户的默认配置
useradd -D 选项: 修改默认选项的值
	修改的结果保存于/etc/default/useradd文件中
usermod: 修改用户属性
	-u --uid : 修改用户的ID为此处指定的ID
	-g --gid : 修改用户所属的基本组
	-G --groups : 修改用户的附加组，原来的附加组会被覆盖
	-a --append : 与-G一同使用，用于为用户追加新的附加组
	-c --comment : 修改注释信息
	-d --home_dir : 修改用户家目录，用户原有的文件不会被转移至新位置
	-m --move_home : 只能与-d一同使用，用户将原来的家目录移动为新的家目录
	-l --login : 修改用户名
	-s --shell : 修改用户的默认shell
	-L --lock : 锁定用户密码，即在用户原来的密码字符串之前添加一个‘!’
	-U --unlock : 解锁用户的密码
userdel: 删除用户
	-r: 删除用户时一并删除其家目录
练习1: 创建用户gentoo，UID为4001，基本组为gentoo,附加组为distro(GID为
5000)和peguin(GID为5001)
	useradd gentoo -u 4001 -g gentoo -G distro,peguin
	
练习2: 创建用户Fedora，其注释信息为"Fedora Core",默认shell为/bin/tcsh
	useradd Fedora -c "Fedora Core" -s /bin/tcsh
	
练习3: 修改gentoo用户的家目录为/var/temp/gentoo,要求其原有的文件仍能被用户访问
	usermod -d /var/temp/gentoo -m gentoo
	
练习4: 为gentoo新增附加组netadmin
	usermod -a -G netadmin gentoo

passwd命令
	passwd: 修改用户自己的密码
	passwd USERNAME: 修改指定用户的密码，但仅限root有权限
	-l,-u: 锁定和解锁用户
	-d: 清除用户密码串
	-e DATE: 过期期限，日期
	-i DAYS: 非活动期限
	-n DAYS: 密码的最短使用期限
	-x DAYS: 密码的最长使用期限
	-w DAYS: 警告期限
	--stdin
		echo "password" | passwd --stdin USERNAME 

gpasswd命令
	组密码文件: /etc/gshadow
	-a USERNAME: 向组中添加用户
	-d USERNAME: 向组中移除用户
```
# 权限管理
```bash
进程安全上下文
	进程对文件的访问权限应用模型
		进程的属主和文件的属主是否相同，如果相同，则应用属主权限
		否则，则检查进程的属组和文件的属组
		否则，则只能应用other权限
		
文件
	r: 可获取文件数据
	w: 可修改文件数据
	x: 可将此文件运行为进程
	
目录
	r: 可列出目录内的文件名列表，但不能显示详细信息
	w: 可对目录内文件进行操作，创建或删除
	x: 可进入此目录内，能列出目录内文件的详细信息
	
权限管理命令
	chmod
		mode表示法
			赋权表示法：直接操作一类用户的所有权限
				chmod u=rwx,g=rx,o= /FILE
			授权表示法：直接操作一类用户的某一权限
				chmod u+r,g-w,o-x /FILE
		八进制表示法
			chmod 644 /FILE
		模板表示法
			使用某个文件的权限作为模板进行赋权
			chmod --reference=/etc/passwd /FILE
		选项
			-R: 递归修改
			例：将脚本目录里的文件全部加上执行权限
				chmod -R a+x /script/
				
从属关系管理命令
	chown命令
			chown [option]... [owner][:group] FILE
			chown [option]... --reference=RFILE FILE
			选项
				-R: 递归修改
				
umsk: 文件的权限反向掩码
	文件: 666-umask
	目录: 777-umask
	注意: 之所以文件用666去减，表示文件默认不能拥有执行权限
		umsk:023
			666-023=643=644 当有奇数出现时，自动加1				
	命令
		umask: 查看当前umask
		umask MASK: 设置umask
	注意: 此类设定仅对当前shell进程有效
	
练习:
	1.新建系统组mariadb,新建系统用户mariadb,属于mariadb组，要求其没有家目录，且shell为/sbin/nologin,尝试root切换至用户，查看命令提示符
	useradd -g mariadb  -M -s /sbin/nologin mariadb

	2.新建GID为5000的组mageedu,新建用户gentoo,要求其家目录为/users/gentoo,密码同用户名
	 groupadd -g 5000 mageedu
	 
	3.新建用户fedora,其家目录为/users/fedora,密码同用户名
	useradd gentoo -d /users/gentoo ; echo "gentoo" | passwd --stdin gentoo
	4.新建用户www,其家目录为/users/www;删除www,但保留家目录
	useradd www -d /users/www ; userdel www
	
	5.为用户gentoo和fedora新增附加组mageedu
	usermod -aG mageedu gentoo
	usermod -aG mageedu fedora
	
	gpasswd -d|-a gentoo mageedu
	gpasswd -d|-a fedora mageedu 组内删除或添加用户
	注意：组添加到多个用户内，需要一次一次操作，无法一条命令完成
	
	6.复制目录/var/log 至/tmp目录，修改/tmp/log及其内部的所有文件的属组为mageedu,并让属组对目录本身拥有写权限
	cp -r /var/log/ /tmp/	
	chown -R :mageedu /tmp/log	
	chmod g+w /tmp/log/
```
# install及mktemp
```bash
install 
	install - copy files and set attributes
	单源复制
		install [OPTION]... [-T] SOURCE DEST
	多源复制
	    install [OPTION]... SOURCE... DIRECTORY
	    install [OPTION]... -t DIRECTORY SOURCE...
	创建空目录
	    install [OPTION]... -d DIRECTORY...
	    
	常用选项
		-m, --mode=MODE: 设定目标文件权限，默认755
		-o, --owner=OWNER: 设定目标文件属主
		-g, --group=GROUP: 设定目标文件属组
mktemp
	mktemp - creat a temporary file or directory
	mktemp [option]... [template]
		常用选项
			-d: 创建临时目录
			-u: 干跑，不创建
	注意：mktemp会创建的临时文件名直接返回，因此，可直接通过命令引用保存
	fileName=$(mktemp /tmp/file.XXX)
 	
```