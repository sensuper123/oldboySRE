# 命令历史
```bash
1.
	shell进程会在其会话中保存此前用户提交执行过的命令
	定制history的功能，可通过环境变量实现
		HISTSIZE:shell进程可保留的命令历史条数
		HISTFILE:永久保留命令历史的文件
			.bash_history 家目录
		HISTFILESIZE:命令历史文件的大小
	命令用法
		history [-c] [-d 偏移量] [n]
		history -anrw [文件名]
		history -ps 参数 [参数...]
		-c : 清空命令历史
		-d offset : 删除指定命令历史
		-r : 从文件读取命令历史到历史列表中
		-w : 把历史列表中的命令追加至历史文件中
		history \# : 显示最近的\#条命令
	调用命令历史列表中的命令
		!\# : 再一次执行历史列表中的第\#条命令
		!! : 再一次执行上一条命令
		!STRING : 再一次执行命令历史列表中最近以STRING开头的命令
			注意：命令的重复执行有时候需要幂等性
	调用上一条命令的最后一个参数
		ESC,.
		字符串:!$
	控制命令历史记录的方式
		环境变量:HISTCONTROL
			ignoredups:忽略重复的命令
			ignorespace:忽略以空白字符开头的命令
			ignoreboth:以上两者同时生效
	修改变量的值
		NAME='VALUE'

```
# 补全命令
```bash
	shell程序在接收到用户执行命令的请求，分析完成之后，最左侧的字
	符串会被当做命令
	命令查找机制
		查找内部命令
		跟进PATH环境变量中设定的目录，自左而右逐个搜索目录下的文件名
	给定的打头字符串如果能唯一标识某命令程序文件，则直接补全
	不能唯一标识某命令程序文件，再击tab键盘，会给出列表
```
# 路径补全
```bash
	在给定的起始路径下，以对应路径下的打头字符串来逐一匹配起始路径
	下的每个文件
```
# 命令行展开
```bash
命令行展开
	~ : 自动展开为用户的家目录，或指定用户的家目录
	{}: 可承载一个以逗号分割的路径列表，并能够将其展开为多个路径
		例如: /tmp/{a,b} 相当于 /tmp/a /tmp/b
	例题:创建如下目录结构
		/tmp/mysysroot/
			bin
			sbin
			etc
				sysconfig
					network-scripts
			usr
				bin
				sbin
				local
					bin
	答案: mkdir /tmp/mysysroot/{bin,sbin,etc/sysconfig/network-scripts,usr/{bin,sbin,local/bin}}
```
# 命令的执行状态结果
```bash
	命令的执行状态结果:
		bash通过状态返回值来输出此结果
			成功 : 0
			失败 : 1-255
		命令执行完成之后，其状态返回值保存于bash的特殊变量$?中
	命令正常执行时，有时还会有命令返回值
		根据命令及其功能不同，结果各不相同
	引用命令的执行结果
		$(COMMAND)
		`COMMAND`
```
# 引用
```bash
	强引用 ''
	弱引用 ""
	命令引用 ``
```
# 快捷键
```bash

	ctrl+a 跳转至命令行行首
	ctrl+e 跳转至命令行行尾
	ctrk+u 删除行首至光标所在处之间的所有字符
	ctrl+k 删除光标所在处至行尾的所有字符
	ctrl+l 相当于clear
```
# 通配符
```bash
globbing 文件名通配(整体文件名匹配，而非部分)
	匹配模式: 元字符
		* : 匹配任意长度的任意字符
		? : 匹配任意单个字符
		[]: 匹配指定范围内的任意单个字符
			[a-z],[A-Z],[0-9],[a-z0-9]
			[[:upper:]] : 所有大写字母
			[[:lower:]] : 所有小写字符
			[[:alpha:]] : 所有字母
			[[:dight:]] : 所有数字
			[[:alnum:]] : 所有的字母和数字
			[[:space:]] : 所有空格字符
			[[:punct:]] : 所有标点符号
		[^] : 匹配指定范围外的任意单个字符
			[^[:upper:]]
			[^0-9]
			[^[:alnum:]]
	练习1：显示/var目录下所有以1开头，以一个小写字母结尾，且中间出现一位任意字符的文件或目录
	ls /var/test/1?[[:lower:]]

	练习2：显示/etc目录下，以任意一位数字开头，且以非数字结尾的文件或目录
	ls -d /var/[0-9]*[^0-9]
	
	练习3：显示/etc目录下，以非字母开头，后面跟一个字母及其他任意长度字符的文件或目录
	ls -d /etc/[^a-z][a-z]*
	
	练习4: 复制/etc目录下，所有以m开头，以非数字结尾的文件或目录至/tmp/mage
	 cp -r /etc/m*[^0-9] /tmp/mage
	 
	练习5: 复制/usr/share/man目录下，所有以man开头，后跟一个数字结尾的文件或目录至/tmp/man目录下
	cp -r /usr/share/man/man[0-9] /tmp/man

	练习6: 复制/etc目录下，所有以.conf结尾，且以m,n,r,p开头的文件或目录至/tmp/conf.d/目录下
	cp -r /etc/[mnrp]*.conf /tmp/conf.d
```
# 重定向及管道
```bash
程序:指令+数据
	程序:IO

	可输入的设备:文件
		键盘设备、文件系统上的常规文件、网卡等
	可用于输出的设备:文件
		显示器、文件系统上的常规文件、网卡等
		
	程序的数据流有三种
		输入的数据流： <-- 标准输入(stdin)，键盘
		输出的数据流： --> 标准输出(stdout)，显示器
		错误输出流：   --> 错误输出(stderr)，显示器

	fd: file descriptor，文件描述符
		标准输入：0
		标准输出：1
		错误输出：2
IO重定向
	输出重定向：>
		特性：覆盖输出
	输出重定向：>>
		特性：追加输出
	set -C 
		禁止覆盖输出重定向至以存在的文件
		此时可使用强制覆盖重定向：>|
	set +C
		关闭上述特性
	错误输出重定向
		2>,2>>
	合并正常输出流和错误输出流
		&> , &>>
		COMMAND > /path/to/somefile 2>&1
	输入重定向
		<
	Here Docutment: \<<
		cat \<<EOF 在此处创建文件并cat出来
		cat > /path/to/somefile \<<EOF 在此处创建文件并cat出来，再重定向
	管道：连接程序，实现将前一个命令的输出直接定向后一个命令的程序当输入
	tee命令：
		COMMAND | tee /PATH/TO/SOMEFILE 有两条输出路径
		例如
			cat /etc/passwd | tee  /tmp/text | tr 'a-z' 'A-Z'
	练习1:把/etc/passwd文件的前6行的信息转换为大写字符后输出
		head -n 6 /etc/passwd | tr 'a-z' 'A-Z'
```
# 命令hash
```bash
缓存此前命令的查找结果:key-value
	key:搜索键
	vlaue:值
	hash命令
		hash: 列出
		hash -d COMMAND: 删除
		hash -r: 清空
```
# bash变量
```bash
终端，附着在终端的接口程序
	GUI: KDE, GNome,Xfce
	CLI: /etc/shells

程序：指令+数据
	指令：由程序文件提供
	数据：IO设备、文件、管道、变量
程序：算法+数据结构

变量：变量名+指向的内存空间

变量赋值：name=value
变量类型：存储格式、表达的数据范围、参与的运算
	编程语言：
		强类型变量
		弱类型变量
			bash把所有变量统统视左字符型
			bash中的变量无需事先声明；相当于声明和赋值同时实现
变量替换：把变量名出现的位置替换为其所指向的内存空间中数据
变量引用：$(var_name),$var_name
变量名：变量名只能包含数字、字母和下划线，而且不能以数字开头

bash变量类型：
	本地变量：作用域仅为当前shell进程
		变量赋值: name=value
		变量引用: $(name),$name
		查看变量: set
		撤销变量: unset name
		
		
	环境变量：作用域为当前shell及其子进程
		变量赋值: export name=value
				 name=value,export name
				 declare -x name=value
				 name=value,declare -x name
		变量引用: $(name),$name
			注意: bash内嵌了许多环境变量(通常为全大写字符)，PATH,HISTFILE
		查看环境变量: env,printenv,declare -x ,export
		撤销环境变量: unset name
		
		
	只读变量:
		declare -r name
		readonly name
			只读变量无法重新赋值，也无法撤销，存活时间为当前shell进程的生命周期
			
			
	局部变量：作用域仅为某代码片段(函数上下文)
	位置参数变量：当执行脚本的shell进程传递的参数
	特殊变量：shell内置的有特殊功能的变量
		$?:
			0: 成功
			1-255: 失败

```
# 命令多执行(逻辑运算)
```bash
COMMAND;COMMAND;COMMAND...
逻辑运算:
	运算数: 真(true,yes,on,1)
			假(false,no,off,0)
	
	与:
		1 && 1 = 1
		1 && 0 = 0
		0 && 1 = 0
		0 && 0 = 0
	
	或
		1 || 1 = 1
		1 || 0 = 1
		0 || 1 = 0
		0 || 0 = 0
	
	非
		!1=0
		!0=1

短路法则
	COMMAND1 && COMMAND2
		COMMAND1为“假”，则COMMAND2不会再执行
	COMMAND1 || COMMAND2
		COMMAND1为“真”，则COMMAND2不会再执行
	示例
		id $username || useradd $username
```